"use strict";var t,e,r,s;Object.defineProperty(exports,"__esModule",{value:!0}),function(t){t.string="string",t.number="number",t.date="date",t.null="null",t.symbol="symbol",t.any="any",t[void 0]="undefined"}(t||(t={})),function(t){t.array="Array",t.map="Map",t.object="object",t.set="set",t.scalar="scalar",t.function="function",t.any="any"}(e||(e={})),function(t){t.byValue="value",t.byKey="key",t.byBoth="both"}(r||(r={})),function(t){t[t.continue=0]="continue",t[t.last=1]="last",t[t.stop=2]="stop"}(s||(s={}));var n=Object.freeze({__proto__:null,get TypeEnum(){return t},get FormEnum(){return e},get booleanMode(){return r},get stopperEnum(){return s}});const i=Symbol("ABSENT");var o=Object.freeze({__proto__:null,ABSENT:i});function u(t){return e=>typeof e===t}function a(t){return![i,void 0].includes(t)}function c(t){return[i,null,void 0].includes(t)}const h=u("number");function l(t,e=!1){return!(!Array.isArray(t)||e&&!t.length)}const f=t=>t instanceof Map;function p(t,e=!1){return t&&"object"==typeof t&&(e||!(l(t)||f(t)))}const m=u("function"),d=u("symbol"),y=(t,e={})=>("string"==typeof t&&(t=new Error(t)),a(e)?p(e)||(e={notes:e}):e={},Object.assign(t,e));const g=u("undefined"),b=[{name:t.undefined,test:g,isForm:!1},{name:e.map,test:f,isForm:!0},{name:t.symbol,test:d,isForm:!1},{name:e.array,test:l,isForm:!0},{name:e.function,test:m,isForm:!0},{name:t.date,test:t=>t instanceof Date,isForm:!1},{name:e.set,test:t=>t instanceof Set,isForm:!0},{name:e.object,test:p,isForm:!0},{name:t.string,test:function(t,e=!1){return"string"==typeof t&&(!e||!!t)},isForm:!1},{name:t.number,test:h,isForm:!1},{name:e.scalar,test:()=>!0,isForm:!0}];function v(t){for(let e=0;e<b.length;e+=1){const r=b[e];if(r.isForm&&r.test(t))return r.name}return e.scalar}function _(t){return[e.map,e.map,e.array,e.object,e.set].includes(t)}function w(t){for(let e=0;e<b.length;e+=1){const r=b[e];if(!r.isForm)try{if(r.test(t))return r.name}catch(t){console.log("error in def",r,t)}}return v(t)}var I="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},k={exports:{}};!function(t,e){var r="__lodash_hash_undefined__",s=9007199254740991,n="[object Arguments]",i="[object Boolean]",o="[object Date]",u="[object Function]",a="[object GeneratorFunction]",c="[object Map]",h="[object Number]",l="[object Object]",f="[object Promise]",p="[object RegExp]",m="[object Set]",d="[object String]",y="[object Symbol]",g="[object WeakMap]",b="[object ArrayBuffer]",v="[object DataView]",_="[object Float32Array]",w="[object Float64Array]",k="[object Int8Array]",j="[object Int16Array]",O="[object Int32Array]",A="[object Uint8Array]",S="[object Uint8ClampedArray]",K="[object Uint16Array]",x="[object Uint32Array]",E=/\w*$/,z=/^\[object .+?Constructor\]$/,F=/^(?:0|[1-9]\d*)$/,B={};B[n]=B["[object Array]"]=B[b]=B[v]=B[i]=B[o]=B[_]=B[w]=B[k]=B[j]=B[O]=B[c]=B[h]=B[l]=B[p]=B[m]=B[d]=B[y]=B[A]=B[S]=B[K]=B[x]=!0,B["[object Error]"]=B[u]=B[g]=!1;var C="object"==typeof I&&I&&I.Object===Object&&I,M="object"==typeof self&&self&&self.Object===Object&&self,q=C||M||Function("return this")(),$=e&&!e.nodeType&&e,T=$&&t&&!t.nodeType&&t,L=T&&T.exports===$;function P(t,e){return t.set(e[0],e[1]),t}function D(t,e){return t.add(e),t}function U(t,e,r,s){var n=-1,i=t?t.length:0;for(s&&i&&(r=t[++n]);++n<i;)r=e(r,t[n],n,t);return r}function R(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function N(t){var e=-1,r=Array(t.size);return t.forEach((function(t,s){r[++e]=[s,t]})),r}function V(t,e){return function(r){return t(e(r))}}function W(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r}var G,H=Array.prototype,J=Function.prototype,Q=Object.prototype,X=q["__core-js_shared__"],Y=(G=/[^.]+$/.exec(X&&X.keys&&X.keys.IE_PROTO||""))?"Symbol(src)_1."+G:"",Z=J.toString,tt=Q.hasOwnProperty,et=Q.toString,rt=RegExp("^"+Z.call(tt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),st=L?q.Buffer:void 0,nt=q.Symbol,it=q.Uint8Array,ot=V(Object.getPrototypeOf,Object),ut=Object.create,at=Q.propertyIsEnumerable,ct=H.splice,ht=Object.getOwnPropertySymbols,lt=st?st.isBuffer:void 0,ft=V(Object.keys,Object),pt=Tt(q,"DataView"),mt=Tt(q,"Map"),dt=Tt(q,"Promise"),yt=Tt(q,"Set"),gt=Tt(q,"WeakMap"),bt=Tt(Object,"create"),vt=Rt(pt),_t=Rt(mt),wt=Rt(dt),It=Rt(yt),kt=Rt(gt),jt=nt?nt.prototype:void 0,Ot=jt?jt.valueOf:void 0;function At(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var s=t[e];this.set(s[0],s[1])}}function St(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var s=t[e];this.set(s[0],s[1])}}function Kt(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var s=t[e];this.set(s[0],s[1])}}function xt(t){this.__data__=new St(t)}function Et(t,e){var r=Vt(t)||function(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&Wt(t)}(t)&&tt.call(t,"callee")&&(!at.call(t,"callee")||et.call(t)==n)}(t)?function(t,e){for(var r=-1,s=Array(t);++r<t;)s[r]=e(r);return s}(t.length,String):[],s=r.length,i=!!s;for(var o in t)!e&&!tt.call(t,o)||i&&("length"==o||Dt(o,s))||r.push(o);return r}function zt(t,e,r){var s=t[e];tt.call(t,e)&&Nt(s,r)&&(void 0!==r||e in t)||(t[e]=r)}function Ft(t,e){for(var r=t.length;r--;)if(Nt(t[r][0],e))return r;return-1}function Bt(t,e,r,s,f,g,I){var z;if(s&&(z=g?s(t,f,g,I):s(t)),void 0!==z)return z;if(!Jt(t))return t;var F=Vt(t);if(F){if(z=function(t){var e=t.length,r=t.constructor(e);e&&"string"==typeof t[0]&&tt.call(t,"index")&&(r.index=t.index,r.input=t.input);return r}(t),!e)return function(t,e){var r=-1,s=t.length;e||(e=Array(s));for(;++r<s;)e[r]=t[r];return e}(t,z)}else{var C=Pt(t),M=C==u||C==a;if(Gt(t))return function(t,e){if(e)return t.slice();var r=new t.constructor(t.length);return t.copy(r),r}(t,e);if(C==l||C==n||M&&!g){if(R(t))return g?t:{};if(z=function(t){return"function"!=typeof t.constructor||Ut(t)?{}:(e=ot(t),Jt(e)?ut(e):{});var e}(M?{}:t),!e)return function(t,e){return qt(t,Lt(t),e)}(t,function(t,e){return t&&qt(e,Qt(e),t)}(z,t))}else{if(!B[C])return g?t:{};z=function(t,e,r,s){var n=t.constructor;switch(e){case b:return Mt(t);case i:case o:return new n(+t);case v:return function(t,e){var r=e?Mt(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}(t,s);case _:case w:case k:case j:case O:case A:case S:case K:case x:return function(t,e){var r=e?Mt(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}(t,s);case c:return function(t,e,r){return U(e?r(N(t),!0):N(t),P,new t.constructor)}(t,s,r);case h:case d:return new n(t);case p:return function(t){var e=new t.constructor(t.source,E.exec(t));return e.lastIndex=t.lastIndex,e}(t);case m:return function(t,e,r){return U(e?r(W(t),!0):W(t),D,new t.constructor)}(t,s,r);case y:return u=t,Ot?Object(Ot.call(u)):{}}var u}(t,C,Bt,e)}}I||(I=new xt);var q=I.get(t);if(q)return q;if(I.set(t,z),!F)var $=r?function(t){return function(t,e,r){var s=e(t);return Vt(t)?s:function(t,e){for(var r=-1,s=e.length,n=t.length;++r<s;)t[n+r]=e[r];return t}(s,r(t))}(t,Qt,Lt)}(t):Qt(t);return function(t,e){for(var r=-1,s=t?t.length:0;++r<s&&!1!==e(t[r],r,t););}($||t,(function(n,i){$&&(n=t[i=n]),zt(z,i,Bt(n,e,r,s,i,t,I))})),z}function Ct(t){return!(!Jt(t)||(e=t,Y&&Y in e))&&(Ht(t)||R(t)?rt:z).test(Rt(t));var e}function Mt(t){var e=new t.constructor(t.byteLength);return new it(e).set(new it(t)),e}function qt(t,e,r,s){r||(r={});for(var n=-1,i=e.length;++n<i;){var o=e[n],u=s?s(r[o],t[o],o,r,t):void 0;zt(r,o,void 0===u?t[o]:u)}return r}function $t(t,e){var r,s,n=t.__data__;return("string"==(s=typeof(r=e))||"number"==s||"symbol"==s||"boolean"==s?"__proto__"!==r:null===r)?n["string"==typeof e?"string":"hash"]:n.map}function Tt(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return Ct(r)?r:void 0}At.prototype.clear=function(){this.__data__=bt?bt(null):{}},At.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},At.prototype.get=function(t){var e=this.__data__;if(bt){var s=e[t];return s===r?void 0:s}return tt.call(e,t)?e[t]:void 0},At.prototype.has=function(t){var e=this.__data__;return bt?void 0!==e[t]:tt.call(e,t)},At.prototype.set=function(t,e){return this.__data__[t]=bt&&void 0===e?r:e,this},St.prototype.clear=function(){this.__data__=[]},St.prototype.delete=function(t){var e=this.__data__,r=Ft(e,t);return!(r<0)&&(r==e.length-1?e.pop():ct.call(e,r,1),!0)},St.prototype.get=function(t){var e=this.__data__,r=Ft(e,t);return r<0?void 0:e[r][1]},St.prototype.has=function(t){return Ft(this.__data__,t)>-1},St.prototype.set=function(t,e){var r=this.__data__,s=Ft(r,t);return s<0?r.push([t,e]):r[s][1]=e,this},Kt.prototype.clear=function(){this.__data__={hash:new At,map:new(mt||St),string:new At}},Kt.prototype.delete=function(t){return $t(this,t).delete(t)},Kt.prototype.get=function(t){return $t(this,t).get(t)},Kt.prototype.has=function(t){return $t(this,t).has(t)},Kt.prototype.set=function(t,e){return $t(this,t).set(t,e),this},xt.prototype.clear=function(){this.__data__=new St},xt.prototype.delete=function(t){return this.__data__.delete(t)},xt.prototype.get=function(t){return this.__data__.get(t)},xt.prototype.has=function(t){return this.__data__.has(t)},xt.prototype.set=function(t,e){var r=this.__data__;if(r instanceof St){var s=r.__data__;if(!mt||s.length<199)return s.push([t,e]),this;r=this.__data__=new Kt(s)}return r.set(t,e),this};var Lt=ht?V(ht,Object):function(){return[]},Pt=function(t){return et.call(t)};function Dt(t,e){return!!(e=null==e?s:e)&&("number"==typeof t||F.test(t))&&t>-1&&t%1==0&&t<e}function Ut(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Q)}function Rt(t){if(null!=t){try{return Z.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Nt(t,e){return t===e||t!=t&&e!=e}(pt&&Pt(new pt(new ArrayBuffer(1)))!=v||mt&&Pt(new mt)!=c||dt&&Pt(dt.resolve())!=f||yt&&Pt(new yt)!=m||gt&&Pt(new gt)!=g)&&(Pt=function(t){var e=et.call(t),r=e==l?t.constructor:void 0,s=r?Rt(r):void 0;if(s)switch(s){case vt:return v;case _t:return c;case wt:return f;case It:return m;case kt:return g}return e});var Vt=Array.isArray;function Wt(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=s}(t.length)&&!Ht(t)}var Gt=lt||function(){return!1};function Ht(t){var e=Jt(t)?et.call(t):"";return e==u||e==a}function Jt(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function Qt(t){return Wt(t)?Et(t):function(t){if(!Ut(t))return ft(t);var e=[];for(var r in Object(t))tt.call(t,r)&&"constructor"!=r&&e.push(r);return e}(t)}t.exports=function(t){return Bt(t,!0,!0)}}(k,k.exports);const j=k.exports;class O{constructor(t,r){this.compItems=(t,e)=>t===e,this.compKeys=(t,e)=>t===e,this.quiet=!1,this.form=e.object,this.items=[],this.keys=[],this.size=0,this.type=e.object,this.store=t,(null==r?void 0:r.compKeys)&&(this.compKeys=null==r?void 0:r.compKeys),(null==r?void 0:r.compItems)&&(this.compItems=null==r?void 0:r.compItems),this.quiet=!!(null==r?void 0:r.quiet)}withComp(t){return t()}clear(){return this}clone(t){return new O(j(this.store),t)}cloneShallow(t){return new O(j(this.store),t)}cloneEmpty(){return this}get c(){return this.clone()}deleteKey(t){return this}deleteItem(t){return this}filter(t){return this}forEach(t){return this}get(t){return null}hasItem(t){return!1}hasKey(t){return!1}keyOf(t){}map(t){return this}reduce(t,e){return null}reduceC(t,e){return this}set(t,e){return this}sort(t){return this}change(t){return this.store=t,this}keyIter(){return this.keys[Symbol.iterator]()}itemIter(){return this.items[Symbol.iterator]()}storeIter(){return this.store[Symbol.iterator]()}addAfter(t,e){return this}addBefore(t,e){return this}first(t){return[]}last(t){return[]}get firstItem(){}get lastItem(){}removeLast(t){return this}removeFirst(t){return this}}const A=(t,e)=>t===e;class S{constructor(t,e){this.quiet=!1,this._compKeys=A,this._compItems=A,(null==e?void 0:e.compKeys)&&(this.compKeys=(null==e?void 0:e.compKeys)||A),(null==e?void 0:e.compItems)&&(this.compItems=(null==e?void 0:e.compItems)||A),this.quiet=!!(null==e?void 0:e.quiet)}change(t){if("function"==typeof t)try{const e=j(this.store);let r=t(e);if(void 0===r&&(r=e),r===t)throw y("circular change",{newStore:t,target:this});return this.change(r)}catch(e){throw y("functional newStore throws error:",{err:e,newStore:t,target:this})}const e=w(t);if(e!==this.type)throw y("attempt to setStore different type than exists now",{target:this,newStore:t,type:e});return this.update(t,"change")}update(t,e,...r){try{!this.quiet&&this.onChange&&e&&this.onChange(t,e,r)}catch(t){return console.warn("update: onChange error",t),this}return this._store=t,this}sorter(t){return t?(e,r)=>t(e,r,this):void 0}get store(){return this._store}mergeOptions(t){return t?Object.assign(Object.assign({},this.options),t):this.options}get options(){return{quiet:this.quiet,compKeys:this.compKeys,compItems:this.compItems}}get compKeys(){return this._compKeys||A}set compKeys(t){if(!m(t))throw y("improper compKeys function",{target:this,fn:t});this._compKeys=t}get compItems(){return this._compItems||A}set compItems(t){if(!m(t))throw y("improper compItems function",{target:this,fn:t});this._compItems=t}get form(){return v(this._store)}get type(){return w(this._store)}get c(){return S.create(j(this._store))}withComp(t,e){let r=null;const{compKeys:s,compItems:n}=this;try{e.compKeys&&(this.compKeys=e.compKeys),e.compItems&&(this.compItems=e.compItems),r=t()}catch(t){throw this.compKeys=s,this.compItems=n,t}return r}get firstItem(){if(!this.size)return;const[t]=this.first();return t}get lastItem(){if(!this.size)return;const[t]=this.last();return t}}S.create=(t,e)=>new O(t,e);class K{constructor(){this.state=s.continue}get isActive(){return this.state===s.continue}get isStopped(){return this.state===s.stop}get isComplete(){return this.state!==s.continue}get isLast(){return this.state===s.last}final(){this.state=s.last}stop(){this.state=s.stop}stopAfterThis(){this.final()}}class x{static sameKey(t,e,r,s=!0,n=!1){return s&&Array.isArray(e)?e.some((e=>{const s=(null==r?void 0:r.compKeys)?r.compKeys(t,e):t===e;return n&&console.log("MATCH subkey comparison: ",e,"to first key",t,"result: ",s),s})):(null==r?void 0:r.compKeys)?r.compKeys(t,e):t===e}static sameItem(t,e,r,s=!0){return(null==r?void 0:r.compItems)?s&&Array.isArray(e)?e.some((e=>{let s=!1;return s=(null==r?void 0:r.compItems)?r.compItems(t,e):t===e,s})):r.compItems(t,e):t===e}}class E extends S{get size(){return this.store.size}get keys(){return this.store.keys()}get items(){return this.store.values()}hasItem(t){return Array.from(this.items).some((e=>x.sameItem(e,t,this)))}hasKey(t){if(this.store.has(t))return!0;const e=this.keyIter();let r=!1;do{const s=e.next();if(r=!!s.done,r)break;const n=s.value;if(x.sameKey(n,t,this))return!0}while(!r);return!1}set(t,e){let r=!1;const s=this.keyIter();do{const n=s.next();if(r=!!n.done,r)break;const i=n.value;if(x.sameKey(i,t,this))return this.store.set(i,e),this}while(!r);return this.store.set(t,e),this}get(t){return this.reduce(((e,r,s,n,i)=>x.sameKey(s,t,this)?(i.final(),r):e),void 0)}keyOf(t){const e=this.items.indexOf(t);if(-1!==e)return e}deleteKey(t){return this.store.delete(t),this}deleteItem(t){return this.filter((e=>!x.sameItem(e,t,this)))}clear(){return this.store.clear(),this}filter(t){const e=this.cloneEmpty(),r=new K,s=this.storeIter();let n=!1;do{const i=s.next();if(n=!!i.done,n)break;const[o,u]=i.value,a=t(u,o,this.store,r);if(r.isStopped)break;if(a&&e.set(o,u),r.isLast)break}while(!n);return this.update(e.store,"filter",t),this}forEach(t){const e=new K,r=this.storeIter();let s=!1;for(;!s;){const n=r.next();if(s=!!n.done,s)break;const[i,o]=n.value;if(t(o,i,this.store,e),e.isComplete)break}return this}map(t){const e=new K,r=this.storeIter(),s=this.cloneEmpty({quiet:!0});let n=!1;for(;!n;){const i=r.next();if(n=!!i.done,n)break;const[o,u]=i.value,a=t(u,o,this.store,e);if(e.isComplete)break;if(s.set(o,a),e.isComplete)break}return this.update(s.store,"map",t),this}reduce(t,e){const r=new K;let s=e;const n=this.storeIter();let i=!1;for(;!i;){const e=n.next();if(i=!!e.done,i)break;const[o,u]=e.value,a=t(s,u,o,this.store,r);if(r.isStopped)return s;if(s=a,r.isComplete)return a}return s}addAfter(t,e=i){if(e===i)throw new Error("you must define a key to addAfter an item for a compound collection");return this.set(e,t),this}addBefore(t,e=i){if(e===i)throw new Error("you must define a key to addAfter an item for a compound collection");const r=this.cloneEmpty({quiet:!0});return r.set(e,t),this.forEach(((t,s)=>{this.compKeys(e,s)||r.set(s,t)})),this.update(r.store,"addBefore"),this}reduceC(t,e){const r=this.reduce(t,e);return S.create(r)}removeFirst(){const t=this.keys.shift(),e=this.get(t);return this.deleteKey(t),e}removeLast(){const t=this.keys.pop(),e=this.get(t);return this.deleteKey(t),e}first(t){return S.create(this.items).first(t)}last(t){return S.create(this.items).last(t)}}var z="object"==typeof I&&I&&I.Object===Object&&I,F="object"==typeof self&&self&&self.Object===Object&&self,B=z||F||Function("return this")(),C=Object.prototype.toString,M=B.Symbol,q=M?M.prototype:void 0,$=q?q.toString:void 0;function T(t){if("string"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==C.call(t)}(t))return $?$.call(t):"";var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e}var L=function(t){return null==t?"":T(t)};const P=[t.undefined,t.null,t.number,t.string];function D(e,r,s,n){if(s||(s=w(e)),n||(n=w(r)),s===t.date)return n===t.date?D(e.getTime(),r.getTime(),t.number,t.number):D(e.getTime(),r,t.number,n);if(n===t.date)return D(e,r.getTime(),s,t.number);if(s!==n&&P.includes(s)&&P.includes(n)){const t=P.indexOf(s)-P.indexOf(n);return t/Math.abs(t)}return s===t.number&&n===t.number?(e-r)/Math.abs(e-r):s===t.string?n===t.string&&e>r?1:-1:n===t.string?1:_(s)?_(n)?D(L(e),L(r),t.string,t.string):1:_(n)?D(e,L(r),s,t.string):e>r?1:-1}function U(t,e){if(t===e)return 0;if(c(t)){if(c(e))return 0}else if(c(e))return 1;return D(t,e)}class R extends E{constructor(t,e){super(t,e),this.update(t,"constructor",e),this._store=t}get(t){return this._store.has(t)?this._store.get(t):super.get(t)}get keys(){return Array.from(this.store.keys())}get items(){return Array.from(this.store.values())}clone(t){return new R(j(this._store),this.mergeOptions(t))}cloneShallow(t){return new R(new Map(this.store),this.mergeOptions(t))}cloneEmpty(){return new R(new Map)}keyOf(t){return this.reduce(((e,r,s,n,i)=>x.sameItem(r,t,this)?(i.final(),s):e),undefined)}sort(t=U){const e=new Map,r=Array.from(this.keys).sort(this.sorter(t));for(let t=0;t<r.length;t+=1){const s=r[t];e.set(s,this.store.get(s))}return this.update(e,"sort",t),this}hasItem(t){return this.reduce(((e,r,s,n,i)=>x.sameItem(r,t,this)?(i.final(),!0):e),!1)}deleteKey(t){const e=new Map(this.store);return this.forEach(((r,s,n,i)=>{x.sameKey(s,t,this,Array.isArray(t))&&(e.delete(s),i.stop())})),this.update(e,"delete",t),this}keyIter(){return this._store.keys()}itemIter(){return this._store.values()}storeIter(){return this._store.entries()}}var N=Object.freeze({__proto__:null,compare:U,Match:x,Stopper:K,clone:j,amend:function(t,r,s=i){a(s)||(s=v(t));let n=t;switch(s){case e.map:n=new Map(t),r.forEach(((t,e)=>{n.set(e,t)}));break;case e.object:n=Object.assign({},t),Object.keys(r).forEach((t=>{n[t]=r[t]}));break;case e.array:n=[...t],r.forEach(((t,e)=>{n[e]=t}));break;default:console.warn("unhandled amend form:",s)}return n},makeEmpty:function(r,s){a(s)||(s=w(r));let n=r;switch(s){case t.number:n=0;break;case t.string:n="";break;case e.map:n=new Map;break;case e.object:n={};break;case e.array:n=[];break;case t.date:n=new Date;break;case e.set:n=new Set;break;case t.symbol:n=Symbol("");break;default:n=null}return n}});class V extends S{constructor(t,e){super(t,e),this._store=t}get size(){return 0}get(t){return V.err("key"),0}set(t,e){return V.err("set"),this}hasKey(t){return V.err("hasKey"),!1}hasItem(t){return V.err("hasItem"),!1}keyOf(t){V.err("keyOf")}static err(t){throw new Error(`${t} not available for scalar collection`)}get keys(){return V.err("keys"),[]}get items(){return V.err("items"),[]}deleteKey(t){return V.err("delete"),this}clear(){return this.update(void 0,"clear"),this}forEach(t){return V.err("forEach"),this}map(t){return V.err("map"),this}reduce(){return V.err("reduce"),null}appendBefore(t,e){return V.err("reduce"),null}appendAfter(t,e){return V.err("reduce"),null}addAfter(t,e){return V.err("addAfter"),this}removeLast(t){return V.err("removeLast"),this}removeFirst(t){return V.err("removeFirst"),this}addBefore(t,e){return V.err("addAfter"),this}clone(t){return new V(j(this.store),this.mergeOptions(t))}cloneShallow(t){return new V(this.store,this.mergeOptions(t))}cloneEmpty(t){return new V(void 0,this.mergeOptions(t))}deleteItem(t){return V.err("deleteItem"),this}filter(t){return V.err("filter"),this}itemIter(t){return V.err("itemIter"),[].entries()}keyIter(t){return V.err("keyIter"),[].entries()}reduceC(t,e){return V.err("reduceC"),this}sort(t){return V.err("sort"),this}storeIter(t){return V.err("keyIter"),[].entries()}first(t){return V.err("first"),[]}last(t){return V.err("last"),[]}}class W extends S{get keys(){const t=[];for(let e=0;e<this.size;e+=1)t.push(e);return t}forEach(t){const e=new K,r=this.store,s=this.items;for(let n=0;n<this.size&&(t(s[n],n,r,e),!e.isStopped);n+=1);return this}map(t){const e=new K,r=[],s=this.storeIter();let n=!1;do{const i=s.next();if(n=i.done,n)break;const[o,u]=i.value,a=t(u,o,this._store,e);if(e.isStopped)break;if(r[o]=a,e.isComplete)break}while(!n);return this.update(r,"map",t),this}reduce(t,e){const r=new K,s=this.storeIter();let n=e,i=!1;do{const e=s.next();if(i=e.done,i)break;const[o,u]=e.value,a=t(n,u,o,this._store,r);if(r.isStopped)break;if(n=a,r.isComplete)break}while(!i);return n}reduceC(t,e){const r=this.reduce(t,e);return S.create(r)}storeIter(){return this._store.entries()}keyIter(){return this._store.keys()}itemIter(){return this._store.values()}first(t){if(!this.size)return[];if("number"!=typeof t)return[this.get(0)];const e=[];for(let r=0;r<this.size&&r<t;++r)e.push(this.get(r));return e}last(t){if(!this.size)return[];if("number"!=typeof t)return[this.get(0)];const e=[];for(let r=0;r<this.size&&r<t;++r){const t=this.size-r-1;e.push(this.get(t))}return e}get firstItem(){if(this.size)return this.get(0)}get lastItem(){if(this.size)return this.get(this.size-1)}}class G extends W{constructor(t,e){super(t,e),this._store=t}get size(){return this.store.length}get items(){return this.store.split("")}hasItem(t){return t instanceof RegExp?t.test(this.store):this.store.includes(t)}hasKey(t){return!(t%1)&&(t>=0&&t<this.size)}keyOf(t){const e=this.store.indexOf(t);if(-1!==e)return e}set(t,e){const r=this.store.substring(0,t)||"",s=this.store.substring(t+Math.max(e.length,1))||"";return this.update(r+e+s,"set",t,e),this}get(t){if(!(t<0||t>this.size))return this.store.substring(t,t+1)}deleteKey(t){return Array.isArray(t)?this.filter(((e,r)=>!x.sameKey(r,t,this))):this.set(t,"")}deleteItem(t){if(Array.isArray(t)){const e=this.clone({quiet:!0});e.filter((e=>!x.sameItem(e,t,this))),this.update(e.store,"deleteItem",t)}let e=this.store,r=e.length;do{r=e.length,e=e.replace(t,"")}while(e&&e.length<r);return this.update(e,"deleteItem",t),this}clear(){return this.update("","clear"),this}reverse(){return new G(this.items.reverse().join(""))}sort(t){const e=S.create(this.store.split(""),this.mergeOptions({quiet:!0}));return e.sort(this.sorter(t)),this.update(e.store.join(""),"sort",t),this}clone(t){return new G(this.store,this.mergeOptions(t))}cloneShallow(t){return new G(this.store,this.mergeOptions(t))}cloneEmpty(t){return new G("",this.mergeOptions(t))}filter(t){const e=this.reduce(((e,r,s,n,i)=>t(r,s,this.store,i)&&i.isActive?`${e}${r}`:e),"");return this.update(e,"filter",t),this}difference(t,e=r.byKey){if("string"==typeof t||Array.isArray(t)){const e=new G(this.store);return e.deleteItem(t),e}return this.difference(t.store)}union(t,e=r.byKey){if("string"==typeof t)return this.union(t.split(""));if(Array.isArray(t)){const e=[...this.items,...t].reduce(((t,e)=>t.includes(e)?t:t+e),"");return new G(e)}return this.union(t.store)}map(t){const e=new K,r=[],s=this.storeIter();let n=!1;do{if(n=s.next().done,n)break;const[i,o]=s.value,u=t(o,i,this._store,e);if(e.isStopped)break;if(r.push(u),e.isComplete)break}while(!n);return this.update(r.join(""),"map",t),this}intersection(t){if("string"==typeof t)return this.intersection(t.split(""));if(Array.isArray(t)){const e=this.items.filter((e=>t.includes(e)));return new G(e.join(""))}return this.intersection(t.items)}storeIter(){return this.items.entries()}keyIter(){return this.keys[Symbol.iterator]()}itemIter(){return this.items[Symbol.iterator]()}addAfter(t,e){return this.update(`${this.store}${t}`,"addBefore"),this}addBefore(t,e){return this.update(`${t}${this.store}`,"addBefore"),this}removeFirst(){const t=this.store.substring(0,1),e=this.store.substring(1);return this.update(e,"removeFirst"),t}removeLast(){const t=this.store.substring(this.size-1),e=this.store.substring(0,this.size-1);return this.update(e,"removeLast"),t}first(t){return this.size&&"number"!=typeof t?[this.store.substring(0,1)]:S.create(this.items).first(t)}last(t){return this.size&&"number"!=typeof t?[this.store.substring(this.size-1)]:S.create(this.items).last(t)}}class H extends W{constructor(t,e){super(t,e),this.update(t,"constructor"),this._store=t}get size(){return this.store.length}get items(){return[...this.store]}get(t){return this.store[t]}set(t,e){const r=[...this.store];return r[t]=e,this.update(r,"set",t,e),this}keyOf(t){let e=this.store.indexOf(t);return-1===e&&(e=void 0),e}hasItem(t){return this.store.includes(t)}clear(){return this.update([],"clear"),this}deleteKey(t){return this.filter(((e,r)=>!x.sameKey(r,t,this)))}deleteItem(t){return this.store.filter((e=>!x.sameItem(e,t,this)))}hasKey(t){return t>=0&&t<this.size&&!(t%1)}sort(t=U){return this.update(this.store.sort(this.sorter(t)),"sort",t),this}clone(t){return new H(j(this.store),this.mergeOptions(t))}cloneShallow(t){return new H([...this.store],this.mergeOptions(t))}cloneEmpty(t){return new H([],this.mergeOptions(t))}filter(t){const e=new K,r=[];for(let s=0;s<this.size;s+=1){const n=this.get(s),i=t(n,s,this.store,e);if(e.isStopped)break;if(i&&r.push(n),e.isLast)break}return this.update(r,"filter",t),this}addAfter(t,e){return this.update([...this.store,t],"addBefore"),this}addBefore(t,e){return this.update([t,...this.store],"addBefore"),this}removeFirst(){const t=[...this.store],e=t.shift();return this.update(t,"removeFirst"),e}removeLast(){const t=[...this.store],e=t.pop();return this.update(t,"removeFirst"),e}first(t){return t?this.store.slice(0,t):[this.store[0]]}last(t){return t?this.store.slice(-t):[this.store[this.size-1]]}get firstItem(){if(this.size)return this.store[0]}get lastItem(){if(this.size)return this.store[this.size-1]}}class J extends E{constructor(t,e){super(t,e),this.update(t,"constructor",e),this._store=t}get size(){return Array.from(this.keys).length}get keys(){return Array.from(Object.keys(this.store))}get items(){return Array.from(Object.values(this.store))}get(t){return this.store[t]}set(t,e){return this._store[t]=e,this}keyOf(t){const e=this.keys;for(let r=0;r<e.length;r+=1){const s=e[r],n=this.get(s);if(x.sameItem(n,t,this))return s}}hasItem(t){return this.items.some((e=>x.sameItem(e,t,this)))}hasKey(t){return this.keys.some((e=>x.sameKey(e,t,this)))}clear(){return this.update({},"clear"),this}deleteKey(t){const e=Object.assign({},this.store);return delete e[t],this.update(e,"deleteKey",t),this}sort(t=U){const e=Array.from(this.keys).sort(this.sorter(t)),r={};return e.forEach((t=>{r[t]=this.get(t)})),this.update(r,"sort",t),this}clone(t){return new J(j(this._store),this.mergeOptions(t))}cloneShallow(t){return new J(Object.assign({},this.store),this.mergeOptions(t))}cloneEmpty(t){return new J({},this.mergeOptions(t))}keyIter(){return Object.keys(this.store)[Symbol.iterator]()}itemIter(){return Object.values(this.store)[Symbol.iterator]()}storeIter(){return Object.entries(this.store)[Symbol.iterator]()}addAfter(t,e){if(void 0===e)throw new Error("you must define a key to addAfter an item for a compound collection");return this.set(String(e),t),this}addBefore(t,e){if(void 0===e)throw new Error("you must define a key to addAfter an item for a compound collection");const r=this.cloneEmpty({quiet:!0});return r.set(String(e),t),this.forEach(((t,s)=>{this.compKeys(e,s)||r.set(s,t)})),this.update(r.store,"addBefore"),this}}class Q extends S{constructor(t,e){super(t,e),this._store=t}clear(){return this.update(new Set,"clear"),this}clone(t){return new Q(new Set(this.store),this.mergeOptions(t))}deleteItem(t){const e=new Set(this._store);return e.delete(t),this.update(e,"deleteItem"),this}deleteKey(t){if(Array.isArray(t)){const e=this.reduce(((e,r,s)=>(t.includes(s)||e.add(r),e)),new Set);return this.update(e,"deleteKey"),this}if(this.hasKey(t)){const e=this.get(t),r=new Set(this._store);r.delete(e),this.update(r,"deleteKey")}return this}add(t){const e=new Set(this._store);return e.add(t),this.update(e,"add")}filter(t){const e=new Set(this._store);return this.forEach(((r,s,n,i)=>{const o=t(r,s,n,i);i.isActive&&o&&e.add(r)})),this.update(e,"filter"),this}forEach(t){const e=this.clone(this.mergeOptions({quiet:!0})),r=new K,s=e.storeIter();let n=!1;do{const e=s.next();if(n=!!e.done,n)break;const[i,o]=e.value;if(t(o,i,this.store,r),!r.isActive)break}while(!n);return this}get(t){if(!(this.size<=t))return this.items[t]}hasItem(t){return!!this.store.has(t)||this.reduce(((e,r,s,n,i)=>this.compItems(r,t)?(i.final(),!0):e),!1)}hasKey(t){return"number"==typeof t&&this.size>t}itemIter(){return this.store.values()}keyIter(){const t=[];for(let e=0;e<this.size;e+=1)t.push(e);return S.create(t).keyIter()}keyOf(t){if(this.hasItem(t))return this.reduce(((e,r,s,n,i)=>this.compItems(t,r)?(i.final(),s):e),void 0)}map(t){const e=new Set;return this.forEach(((r,s,n,i)=>{const o=t(r,s,this.store,i);i.isActive&&e.add(o)})),this.update(e,"map"),this}reduce(t,e){return S.create(this.items,this.options).reduce(((e,r,s,n,i)=>t(e,r,s,this.store,i)),e)}reduceC(t,e){return this.c.reduce(t,e)}set(t,e){return console.warn("set key/value has unpredictable results on a set collection; use add(item) for consistent results"),t>this.size?this.add(e):this.map(((r,s)=>s===t?e:r))}sort(t){const e=S.create(this.items,this.options);return e.sort(t),this.update(new Set(e.store),"sort"),this}storeIter(){return S.create(this.items).storeIter()}get items(){return Array.from(this.store.values())}get keys(){const t=[];for(let e=0;e<this.size;e+=1)t.push(e);return t}get size(){return this.store.size}addAfter(t,e){const r=new Set(this.store);return r.add(t),this.update(r,"addBefore"),this}addBefore(t,e){const r=new Set([t,...this.items.filter((e=>!this.compItems(e,t)))]);return this.update(r,"addBefore"),this}removeFirst(){const t=new Set(this.store),e=this.keys.shift();return t.delete(e),this.update(t,"removeFirst"),e}removeLast(){const t=new Set(this.store),e=this.keys.pop();return t.delete(e),this.update(t,"removeFirst"),e}cloneEmpty(t){return new Q(new Set,this.mergeOptions(t))}cloneShallow(t){return new Q(new Set(this.store),this.mergeOptions(t))}first(t){return S.create(this.items).first(t)}last(t){return S.create(this.items).last(t)}}var X=(r,s)=>{let n;switch(w(r)){case e.map:n=new R(r,s);break;case t.string:n=new G(r,s);break;case e.array:n=new H(r,s);break;case e.object:n=new J(r,s);break;case e.set:n=new Q(r,s);break;default:n=new V(r,s)}return n};S.create=X,exports.constants=o,exports.create=X,exports.default=X,exports.enums=n,exports.utils=N;
//# sourceMappingURL=index.js.map
